var Zap=function(t){t=t||location.protocol+"//"+location.hostname,this.baseLoc="/"===t.substr(-1)?t:t+"/"};Zap.prototype={$routes:{},$filterPath:function(t){var e="/"===t.substr(-1)?t.substr(0,t.length-1):t,t="/"===e.substr(0,1)?e.substr(1):e;return t},$getParams:function(){var t={};if(this.base&&this.base.match(/\?/)){var e=this.base.split("?")[1];if(e){var a,r=e.split("&");for(a in r){var i=r[a],o=i.split("="),s=o[0],n=o[1]||"";t[s]=n}}}return t},$getPath:function(){return this.base=location.href,this.base},$go:function(t,e){var a,r=this.$routes,i=[],e=e||2,o=!1,t=this.$filterPath(t.replace(this.baseLoc,""));for(a in r){var s=new RegExp(r[a].regex),n=r[a].fn,h=t.split("?")[0].match(s);o||h&&(2==e&&history.pushState({},"",this.baseLoc+t),this.$getPath(),i=h.slice(1)||[],i=i.concat([this.$getParams()]),n.apply(null,i),o=!0)}},$on:function(t,e){var t=this.$filterPath(t)?this.$filterPath(t):null,a=t?t.replace(/\:([^(\/|?)]+)/gi,"([^\\/]+)"):"^s*$",r={};r.regex=a,r.fn=e,r.rawPath=t,this.$routes[t]=r},$trigger:function(){var t=this;window.onpopstate=function(e){var a=t.$getPath().replace(t.baseLoc,"");t.$go(a,1)},document.addEventListener("DOMContentLoaded",function(e){var a,r,i=document.querySelectorAll("[data-zap]");for(r in i)a=i[r],"object"==typeof a&&a.addEventListener("click",function(e){var a=this.getAttribute("href");t.$go(a),e.preventDefault(),e.stopPropagation()})}),t.$go(location.href)}};